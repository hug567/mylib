# 1、命令参数：

```bash
route
	-h                              # 查看帮助
```

# 2、常见用法：

```bash
# 列出当前路由
route
route -n

# 添加默认路由
sudo route add default gw 192.168.1.1
# 添加静态路由：指定网段172.22.195.0/24网络包从指定网络设备wlx502b731c5285收发
sudo route add -net 172.22.195.0/24 dev wlx502b731c5285

# 删除默认路由
sudo route del default gw 192.168.1.1
# 删除指定路由
sudo route del -net 172.22.195.0/24 dev wlx502b731c5285
```

# 3、路由概念：

## 3.1、查看路由：

```bash
 $ route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         192.168.100.1   0.0.0.0         UG    600    0        0 wlx085700fdf522
10.110.0.0      0.0.0.0         255.255.255.0   U     100    0        0 eno1
169.254.0.0     0.0.0.0         255.255.0.0     U     1000   0        0 wlx085700fdf522
172.17.0.0      0.0.0.0         255.255.0.0     U     0      0        0 docker0
192.168.100.0   0.0.0.0         255.255.255.0   U     600    0        0 wlx085700fdf522
```

## 3.2、字段含义：
```bash
Destination: 目标ip，为default(0.0.0.0)时，表示对应的网关是默认网关，所有包都发送到这个网关；
Gateway：网关，0.0.0.0表示跟对应Destination在同一网段的ip通信，不经过默认网关；
Genmask：掩码，默认路由设置为0.0.0.0，Destination是主机时需设置为255.255.255.255；
Flags：标志
	U：路由是可用的（Up）
	H：是一个主机路由
	G：路由是默认网关
	R：恢复动态路由产生的表项
	D：由路由的后台程序动态安装
	M：由路由的后台程序修改
	I：拒绝路由
Iface：网卡名；
```

## 3.3、路由类型：

```bash
# 主机路由：单个IP地址的路由条目，Flag字段中包含H，掩码是255.255.255.255
# 如：目标是100.100.2.136的包，发给路由172.25.31.253
100.100.2.136   172.25.31.253   255.255.255.255 UGH   100    0        0 eth0

# 网络路由：主机可以到达的网络
# 如：与10.110.0.0/24在同一网段的包，不经过网关
10.110.0.0      0.0.0.0         255.255.255.0   U     100    0        0 eno1

# 默认路由：目标IP不在路由表中的包，被发往默认路由对应的网关
0.0.0.0         192.168.100.1   0.0.0.0         UG    600    0        0 wlx085700fdf522
```

## 3.4、windows查看路由表：

```bash
route print
```

# 4、网关：

- 转发数据包，连通不通的子网；

# 5、网络包发送过程：

- 1、若目标ip在本机，则直接访问本地；
- 2、如不在本机，查询路由表，如果由条目包含了目标ip的网段，则通过该条目对应的网卡发出去；
- 3、若没有匹配的条目，则走默认网关；
- 4、若都不通，则报错：网络不可达；

# 6、其他表：

- ARP表：IP地址和MAC地址的映射；
- MAC表：MAC地址与物理接口见的映射；

